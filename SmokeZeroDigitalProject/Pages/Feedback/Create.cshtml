@page
@model SmokeZeroDigitalProject.Pages.Feedback.CreateModel
@{
	ViewData["Title"] = "Tạo Feedback";
}
<h2 class="text-center mb-4">Tạo Feedback</h2>

<div class="mx-auto" style="max-width: 600px;">
    <div class="card shadow">
        <div class="card-body">
            <form method="post">
                <div class="form-group mb-3">
                    <label asp-for="Feedback.CoachId" class="form-label">Coach</label>
                    <select asp-for="Feedback.CoachId" class="form-select" asp-items="Model.CoachSelectList">
                        <option value="">-- Chọn huấn luyện viên --</option>
                    </select>
                    <span asp-validation-for="Feedback.CoachId" class="text-danger"></span>
                </div>

                <div class="form-group mb-3">
                    <label asp-for="Feedback.Content" class="form-label">Nội dung phản hồi</label>
                    <textarea asp-for="Feedback.Content" class="form-control" rows="4"></textarea>
                    <span asp-validation-for="Feedback.Content" class="text-danger"></span>
                </div>

                <div class="form-group mb-3">
                    <label class="form-label">Đánh giá</label>
                    <div class="rating-stars">
                        @for (int i = 1; i <= 5; i++)
                        {
                            <span class="star @(i <= Model.Feedback.Rating ? "filled" : "")"
                                  data-value="@i"
                                  onmouseover="highlightStars(@i)"
                                  onmouseout="resetStars()"
                                  onclick="selectRating(@i)">★</span>
                        }
                        <input type="hidden" asp-for="Feedback.Rating" id="Feedback_Rating" />
                    </div>
                    <span asp-validation-for="Feedback.Rating" class="text-danger"></span>
                </div>

                <input type="hidden" asp-for="Feedback.UserId" />

                <div class="text-center">
                    <button type="submit" class="btn btn-primary">Gửi Feedback</button>
                </div>
            </form>
        </div>
    </div>
</div>


@section Styles {
    <style>
        .rating-stars {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-top: 4px;
        }

        .star {
            font-size: 24px;
            cursor: pointer;
            color: lightgray;
            transition: color 0.2s ease;
        }

            .star.filled {
                color: gold;
            }
    </style>

}


@section Scripts {

    <partial name="_ValidationScriptsPartial" />

    <script>
        let selectedRating = parseInt(document.getElementById("Feedback_Rating").value || 1);

        function highlightStars(starIndex) {
            const stars = document.querySelectorAll(".rating-stars .star");
            stars.forEach((star, index) => {
                star.classList.toggle("filled", index < starIndex);
            });
        }

        function resetStars() {
            highlightStars(selectedRating);
        }

        function selectRating(rating) {
            selectedRating = rating;
            document.getElementById("Feedback_Rating").value = rating;
            resetStars();
        }

        // Đảm bảo hiển thị đúng khi load lại
        window.addEventListener('DOMContentLoaded', () => {
            resetStars();
        });
    </script>



}